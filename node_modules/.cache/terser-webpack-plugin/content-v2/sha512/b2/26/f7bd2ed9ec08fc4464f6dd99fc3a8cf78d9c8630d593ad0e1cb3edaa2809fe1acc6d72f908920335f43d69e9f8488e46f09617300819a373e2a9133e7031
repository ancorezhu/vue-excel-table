{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,i){i(\"201c\"),e.exports=i(\"41oC\")},\"0UNb\":function(e,t,i){\"use strict\";var r=i(\"4IID\");i.n(r).a},\"3GTM\":function(e,t,i){e.exports={title:\"title__vxuSLve\",main:\"main_2C7iyW_-\",features_wrapper:\"features_wrapper_1BNp03xf\",features_title:\"features_title_1pT77ya0\",features_list:\"features_list_tYH0BP8u\",\"excel-table_wrapper\":\"excel-table_wrapper_CfL2LtNd\",github_link:\"github_link_2qUMS9_4\",more:\"more_2j6pmXzp\"}},\"41oC\":function(e,t,i){\"use strict\";i.r(t);var r=i(\"oCYn\"),s=(i(\"VgtF\"),i(\"RQ3N\"),i(\"3Nwd\")),o=i.n(s),n=i(\"luuv\"),l=i.n(n);function a(e,t){var i,r=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)),r}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){var r,s,o;r=e,o=i[s=t],s in r?Object.defineProperty(r,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[s]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i(\"Y7/N\");var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.states={tableWidth:null,tableHeight:null,mainWidth:null,mainHeight:null,rowHeight:28,theaderHeight:30,scrollBarWidth:8,tableBodyLeft:0,tableBodyTop:0,columns:[],data:[],showData:[],domData:[],initialData:null,changeData:[],dataStatusList:[],columnsStatusList:[],editor:{editorRange:{},editorXIndex:0,editorYIndex:0,curEditorCoverValue:\"\",editorShow:!1,editorIsFixed:!1,editing:!1,editType:\"text\",options:[],curEditorWidth:80},autofill:{autofillXIndex:0,autofillYIndex:0,isAutofill:!1,autofillYArr:[]},selector:{isSelected:!1,selectedXIndex:0,selectedYIndex:0,selectedXArr:[],selectedYArr:[]},filters:{},dropdown:{index:null,list:{},key:\"\",sort:\"\"},isMac:!1,adjustLineLeft:0,adjustLineShow:!1,historyData:[],curHisory:0,isOperation:!1,scrollbar:{posX:0,posY:0,xWidth:0,yHeight:0},visibleRowStartIndex:0,visibleRowEndIndex:0}}var t,i;return t=e,(i=[{key:\"calcDomData\",value:function(){var e=this.states;e.visibleRowStartIndex=Math.floor(e.tableBodyTop/e.rowHeight),e.visibleRowEndIndex=e.visibleRowStartIndex+Math.ceil(e.mainHeight/e.rowHeight),e.domData=e.showData.slice(e.visibleRowStartIndex,e.visibleRowEndIndex+1)}},{key:\"initScrollBarLength\",value:function(){var e=this.states,t=e.mainWidth/e.tableWidth*e.mainWidth;t>e.mainWidth?e.scrollbar.xWidth=0:e.scrollbar.xWidth=t<=20?20:t;var i=e.mainHeight/e.tableHeight*e.mainHeight;i>e.mainHeight?e.scrollbar.yHeight=0:e.scrollbar.yHeight=i<=20?20:i}},{key:\"setScrollStatus\",value:function(e,t){var i=this.states;e<=0?i.tableBodyTop=0:e>i.tableHeight-i.mainHeight?i.tableBodyTop=i.tableHeight-i.mainHeight:i.tableBodyTop=e,t<=0?i.tableBodyLeft=0:t>i.tableWidth-i.mainWidth?i.tableBodyLeft=i.tableWidth-i.mainWidth:i.tableBodyLeft=t,i.scrollbar.posX=i.tableBodyLeft/(i.tableWidth-i.mainWidth)*(i.mainWidth-i.scrollbar.xWidth),i.scrollbar.posY=i.tableBodyTop/(i.tableHeight-i.mainHeight)*(i.mainHeight-i.scrollbar.yHeight)}},{key:\"handleIsMac\",value:function(){/macintosh|mac os x/i.test(navigator.userAgent)&&(this.states.isMac=!0)}},{key:\"getEditorContent\",value:function(e){var t=this.states;t.showData[t.editor.editorYIndex][t.columns[t.editor.editorXIndex].key]=e}},{key:\"resetEditor\",value:function(){var e=this.states;e.editor.editing=!1,e.editor.editType=\"text\"}},{key:\"handleAutofill\",value:function(){this.states.autofill.isAutofill=!0,window.addEventListener(\"mouseup\",this.autofillUp.bind(this))}},{key:\"autofillUp\",value:function(){var e=this.states;if(e.autofill.autofillYArr[1]>e.selector.selectedYArr[1]){for(var t=0;t<=e.autofill.autofillYArr[1]-e.autofill.autofillYArr[0];t+=1)for(var i=0;i<=e.selector.selectedXArr[1]-e.selector.selectedXArr[0];i+=1)e.columns[i+e.selector.selectedXArr[0]].disabled||(e.showData[t+e.autofill.autofillYArr[0]][e.columns[i+e.selector.selectedXArr[0]].key]=e.showData[e.selector.selectedYArr[1]][e.columns[i+e.selector.selectedXArr[0]].key]);e.selector.selectedYArr.splice(1,1,e.autofill.autofillYArr[1]);var r=e.autofill.autofillYArr[1];e.autofill.autofillYIndex=r}if(e.autofill.autofillYArr[0]<e.selector.selectedYArr[0]){for(var s=0;s<=e.autofill.autofillYArr[1]-e.autofill.autofillYArr[0];s+=1)for(var o=0;o<=e.selector.selectedXArr[1]-e.selector.selectedXArr[0];o+=1)e.columns[o+e.selector.selectedXArr[0]].disabled||(e.showData[s+e.autofill.autofillYArr[0]][e.columns[o+e.selector.selectedXArr[0]].key]=e.showData[e.selector.selectedYArr[0]][e.columns[o+e.selector.selectedXArr[0]].key]);e.selector.selectedYArr.splice(0,1,e.autofill.autofillYArr[0])}setTimeout((function(){e.autofill.autofillYArr=[],e.autofill.isAutofill=!1}),0)}},{key:\"multiSelect\",value:function(e,t,i,r){var s=this.states;\"selection\"!==r&&(s.selector.isSelected&&setTimeout((function(){s.autofill.autofillXIndex=t>s.editor.editorXIndex?t:s.editor.editorXIndex,s.autofill.autofillYIndex=i>s.editor.editorYIndex?i:s.editor.editorYIndex,s.selector.selectedXIndex=t,s.selector.selectedYIndex=i,s.selector.selectedXIndex>s.editor.editorXIndex?(s.selector.selectedXArr.splice(0,1,s.editor.editorXIndex),s.selector.selectedXArr.splice(1,1,s.selector.selectedXIndex)):(s.selector.selectedXArr.splice(0,1,s.selector.selectedXIndex),s.selector.selectedXArr.splice(1,1,s.editor.editorXIndex)),s.selector.selectedYIndex>s.editor.editorYIndex?(s.selector.selectedYArr.splice(0,1,s.editor.editorYIndex),s.selector.selectedYArr.splice(1,1,s.selector.selectedYIndex)):(s.selector.selectedYArr.splice(0,1,s.selector.selectedYIndex),s.selector.selectedYArr.splice(1,1,s.editor.editorYIndex))}),0),s.autofill.isAutofill&&(i>s.selector.selectedYArr[1]?s.autofill.autofillYArr=[s.selector.selectedYArr[1]+1,i]:i<s.selector.selectedYArr[0]?s.autofill.autofillYArr=[i,s.selector.selectedYArr[0]-1]:s.autofill.autofillYArr=[]))}},{key:\"openDropdown\",value:function(e){var t=this.states;\"number\"!=typeof e||t.dropdown.index===e?t.dropdown.index=null:(t.dropdown.index=e,t.dropdown=JSON.parse(JSON.stringify(d(d({},t.columnsStatusList[t.dropdown.index]),{},{index:t.dropdown.index}))))}},{key:\"selectAllCells\",value:function(){var e=this.states;e.selector.selectedXIndex=e.editor.editorRange.minX,e.selector.selectedYIndex=e.editor.editorRange.minY,e.selector.selectedXArr=[e.editor.editorRange.minX,e.editor.editorRange.maxX],e.selector.selectedYArr=[e.editor.editorRange.minY,e.editor.editorRange.maxY]}},{key:\"handleFilters\",value:function(){var e=this.states;e.columnsStatusList.forEach((function(t){\"selection\"!==t.type&&(t.list?Object.keys(t.list).forEach((function(e){t.list[e].count=0})):t.list={},e.data.forEach((function(e){e[t.key]&&(t.list[e[t.key]]?t.list[e[t.key]].count+=1:(t.list[e[t.key]]={},t.list[e[t.key]].count=1))})),Object.keys(t.list).forEach((function(e){0===t.list[e].count&&delete t.list[e]})))}))}},{key:\"handleErrors\",value:function(){var e=this,t=this.states;setTimeout((function(){t.dataStatusList.forEach((function(i,r){t.columns.forEach((function(s){e.verify(s,t.data[r][s.key])?i.errors.includes(s.key)&&i.errors.splice(i.errors.indexOf(s.key),1):i.errors.includes(s.key)||i.errors.push(s.key)}))}))}),0)}},{key:\"verify\",value:function(e,t){if(!t||e.noVerify)return!0;var i,r;if(e.validate)i=e.validate(t);else switch(e.type){case\"date\":i=function(e){var t=e.match(/^(\\d{1,4})(-|\\/)(\\d{1,2})\\2(\\d{1,2})$/);if(null==t)return!1;var i=new Date(t[1],t[3]-1,t[4]);return i.getFullYear()===Number(t[1])&&i.getMonth()+1===Number(t[3])&&i.getDate()===Number(t[4])}(t);break;case\"month\":i=function(e){var t=e.match(/^(\\d{1,4})(-|\\/)(\\d{1,2})$/);if(null==t)return!1;var i=new Date(t[1],t[3]-1);return i.getFullYear()===Number(t[1])&&i.getMonth()+1===Number(t[3])}(t);break;case\"select\":r=t,i=!!e.options.map((function(e){return e.value})).includes(r);break;case\"number\":i=!isNaN(t);break;default:i=!0}return i}},{key:\"sort\",value:function(e){var t=this.states;t.columnsStatusList.forEach((function(e){e.sort=\"\"})),\"ascending\"===(t.columnsStatusList[t.dropdown.index].sort=e)?t.showData.sort((function(e,i){return e[t.columnsStatusList[t.dropdown.index].key]>i[t.columnsStatusList[t.dropdown.index].key]?1:-1})):t.showData.sort((function(e,i){return e[t.columnsStatusList[t.dropdown.index].key]>i[t.columnsStatusList[t.dropdown.index].key]?-1:1})),t.dropdown.index=null}},{key:\"handleFilter\",value:function(){var e=this.states;e.columnsStatusList[e.dropdown.index]={list:e.dropdown.list,key:e.dropdown.key,sort:e.dropdown.sort};var t=[];Object.keys(e.dropdown.list).forEach((function(i){e.dropdown.list[i].checked&&t.push(i)})),e.filters[e.columnsStatusList[e.dropdown.index].key]=t,this.filterData()}},{key:\"resetFilter\",value:function(){var e=this.states;delete e.filters[e.columnsStatusList[e.dropdown.index].key],Object.keys(e.columnsStatusList[e.dropdown.index].list).forEach((function(t){e.columnsStatusList[e.dropdown.index].list[t].checked=!1})),this.filterData()}},{key:\"filterData\",value:function(){var e=this.states;e.showData=e.data,Object.keys(e.filters).forEach((function(t){e.showData=e.showData.filter((function(i){return e.filters[t].includes(i[t].toString())}))})),e.dropdown.index=null}},{key:\"handleChangeData\",value:function(){var e=this.states,t=JSON.parse(JSON.stringify(e.data)),i=JSON.parse(JSON.stringify(e.initialData));e.changeData=t.filter((function(e,t){return JSON.stringify(e)!==JSON.stringify(i[t])}))}},{key:\"operation\",value:function(e){var t=this.states;t.editor.editing||(\"undo\"===e&&1<t.curHisory&&--t.curHisory,\"recovery\"===e&&t.curHisory<t.historyData.length&&(t.curHisory+=1),t.isOperation=!0,JSON.parse(t.historyData[t.curHisory-1]).forEach((function(e,i){Object.keys(e).forEach((function(r){t.data[i][r]=e[r]}))})),setTimeout((function(){t.isOperation=!1}),0))}},{key:\"clearSelected\",value:function(){for(var e=this.states,t=0;t<=e.selector.selectedYArr[1]-e.selector.selectedYArr[0];t+=1)for(var i=0;i<=e.selector.selectedXArr[1]-e.selector.selectedXArr[0];i+=1)e.columns[i+e.selector.selectedXArr[0]].disabled||(e.showData[t+e.selector.selectedYArr[0]][e.columns[i+e.selector.selectedXArr[0]].key]=\"\")}}])&&c(t.prototype,i),e}(),h={bind:function(e,t){function i(i){if(e.contains(i.target))return!1;t.expression&&t.value(i)}e.__vueClickOutside__=i,document.addEventListener(\"click\",i)},update:function(){},unbind:function(e){document.removeEventListener(\"click\",e.__vueClickOutside__),delete e.__vueClickOutside__}},f={methods:{getData:function(){return this.data},setData:function(e){var t=this;this.data=e,this.$nextTick((function(){t.initData(),t.store.handleFilters()}))},getChangeData:function(){return this.store.states.changeData},getErrorRows:function(){var e=this.store.states.dataStatusList.map((function(e,t){return 0<e.errors.length?t:null}));return this.data.map((function(t,i){return e.includes(i)?{data:t,index:i}:null})).filter((function(e){return e}))},addItem:function(e){var t=this.store.states;this.data.push(e),t.dataStatusList.push({checked:!1,errors:[]})},removeItems:function(e,t){var i=this,r=this.store.states;e&&t instanceof Array&&t.forEach((function(t){var s=i.data.findIndex((function(i){return i[e]===t}));r.dataStatusList.splice(s,1),i.data.splice(s,1)}))}}},p={components:{\"el-checkbox\":o.a},props:{fixed:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!1},allShow:Boolean,columnsWidth:{type:Array,default:function(){return[]}},fixedCount:[String,Number],store:{required:!0}},data:function(){return{checkedAll:!1,adjustWidthValue:80,adjustWidthFlag:!1,adjustWidthIndex:0,adjustWidthType:\"\",mouseX:0}},computed:{columns:function(){return this.store.states.columns},columnsStatusList:function(){return this.store.states.columnsStatusList},dropdown:function(){return this.store.states.dropdown},filters:function(){return this.store.states.filters}},methods:{selectAll:function(){this.$parent.selectAll()},handlerDown:function(e){this.adjustWidthFlag=!0,this.adjustWidthIndex=e,this.store.states.adjustLineShow=!0,window.addEventListener(\"mousemove\",this.handlerMove),window.addEventListener(\"mouseup\",this.handlerUp)},handlerMove:function(e){var t;this.adjustWidthFlag&&(e=e||window.event,80<=(t=this.fixedCount>=this.adjustWidthIndex+1?e.pageX-this.$parent.excelPos.left-this.$refs.tr.children[this.adjustWidthIndex].offsetLeft:e.pageX+this.store.states.tableBodyLeft-this.$parent.excelPos.left-this.$refs.tr.children[this.adjustWidthIndex].offsetLeft)&&(this.adjustWidthValue=t,this.store.states.adjustLineLeft=e.pageX-this.$parent.excelPos.left))},handlerUp:function(){this.$parent.adjustWidth(this.adjustWidthIndex,this.adjustWidthValue),this.adjustWidthFlag=!1,this.store.states.adjustLineShow=!1,window.removeEventListener(\"mousemove\",this.handlerMove),window.removeEventListener(\"mouseup\",this.handlerUp)},openDropdown:function(e){this.store.openDropdown(e)},isActive:function(e){return!(!e||!this.filters.hasOwnProperty(e.key)&&!e.sort)},iconClass:function(e){var t,i,r;switch(e){case\"number\":t=\"number\";break;case\"date\":case\"month\":t=\"date\";break;case\"select\":t=\"select\";break;default:t=\"text\"}return!0,(r=t)in(i={})?Object.defineProperty(i,r,{value:!0,enumerable:!0,configurable:!0,writable:!0}):i[r]=!0,i}}},m=(i(\"NgJc\"),i(\"KHd+\")),y=Object(m.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"ww-theader\",class:{fixed:e.fixed}},[i(\"div\",{ref:\"tr\",staticClass:\"ww-tr\",style:{width:e.store.states.tableWidth+\"px\",height:e.store.states.theaderHeight+\"px\",transform:\"translate3d(\\n        -\"+(e.fixed?0:e.store.states.tableBodyLeft)+\"px,\\n        0,\\n        0\\n      )\"}},e._l(e.columns,(function(t,r){return i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.fixed||e.allShow,expression:\"th.fixed || allShow\"}],key:r,staticClass:\"ww-th\",class:{selection:\"selection\"===t.type},style:{width:e.columnsWidth[r]+\"px\",\"text-align\":t.align},attrs:{title:t.title}},[\"selection\"===t.type?i(\"el-checkbox\",{attrs:{size:\"mini\"},on:{change:e.selectAll},model:{value:e.checkedAll,callback:function(t){e.checkedAll=t},expression:\"checkedAll\"}}):i(\"p\",{staticClass:\"ww-title\",class:{active:e.isActive(e.columnsStatusList[r])},style:{width:e.columnsWidth[r]-20+\"px\"}},[e.showIcon?i(\"span\",{staticClass:\"icon\",class:e.iconClass(t.type)}):e._e(),e._v(\"\\n        \"+e._s(t.title)+\"\\n      \")]),e._v(\" \"),\"selection\"!==t.type?i(\"div\",{staticClass:\"dropdown\",class:{active:e.dropdown.index===r},style:{top:(e.store.states.theaderHeight-14)/2+\"px\"}},[t.action?i(\"i\",{on:{click:function(t){return t.stopPropagation(),e.openDropdown(r)}}}):e._e()]):e._e(),e._v(\" \"),\"selection\"!==t.type?i(\"div\",{staticClass:\"handler\",on:{mousedown:function(t){return e.handlerDown(r)}}}):e._e()],1)})),0)])}),[],!1,null,null,null).exports;function w(e,t){var i,r=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)),r}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(Object(i),!0).forEach((function(t){var r,s,o;r=e,o=i[s=t],s in r?Object.defineProperty(r,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[s]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var v={props:{fixed:{type:Boolean,default:!1},allShow:Boolean,columnsWidth:{type:Array,default:function(){return[]}},cellStyle:{type:[Object,Function],default:function(){return function(){return{}}}},cellClassName:{type:[Object,Function],default:function(){return function(){return{}}}},store:{required:!0},scrollY:{type:Boolean,default:!1}},components:{\"el-checkbox\":o.a},data:function(){return{}},computed:{rowHeight:function(){return this.store.states.rowHeight},columns:function(){return this.store.states.columns},dataStatusList:function(){return this.store.states.dataStatusList},showData:function(){return this.store.states.showData},domData:function(){return this.store.states.domData},editor:function(){return this.store.states.editor},selector:function(){return this.store.states.selector},autofill:function(){return this.store.states.autofill}},methods:{selectionChange:function(){this.$parent.selectionChange()},multiSelect:function(e,t,i,r){this.store.multiSelect(e,t,i,r)},selectCell:function(e,t,i,r){this.$parent.selectCell(e,t,i,r)},format:function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return i?e?\"number\"===t&&parseInt(e,10)?parseInt(e,10).toLocaleString():e:void 0:e},styleObj:function(e,t,i,r,s){return x({width:\"\".concat(s[r],\"px\"),height:\"\".concat(this.rowHeight,\"px\"),textAlign:t.align},this.cellStyle({row:e,column:t,rowIndex:i,columnIndex:r}))},classObj:function(e,t,i,r){return x({disabled:t.disabled,selection:\"selection\"===t.type,error:!this.store.verify(t,e[t.key],i)},this.cellClassName({row:e,column:t,rowIndex:i,columnIndex:r}))}}},b=(i(\"W+Kp\"),Object(m.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"ww-tbody\",class:{fixed:e.fixed,scrollY:e.scrollY,empty:0===e.showData.length},style:{top:e.fixed?e.store.states.theaderHeight+\"px\":\"\"}},[i(\"div\",{style:{width:e.store.states.tableWidth+\"px\",height:(e.showData.length?e.showData.length*e.store.states.rowHeight:80)+\"px\",transform:\"translate3d(\\n        -\"+(e.fixed?0:e.store.states.tableBodyLeft)+\"px,\\n        -\"+e.store.states.tableBodyTop+\"px,\\n        0\\n      )\"}},[e._l(e.domData,(function(t,r){return i(\"div\",{key:r,staticClass:\"ww-tr\",style:{transform:\"translate3d(\\n          0,\\n          \"+(r+e.store.states.visibleRowStartIndex)*e.store.states.rowHeight+\"px,\\n          0\\n        )\"}},e._l(e.columns,(function(s,o){return i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:s.fixed||e.allShow,expression:\"th.fixed || allShow\"}],key:o,staticClass:\"ww-td\",class:e.classObj(t,s,r+e.store.states.visibleRowStartIndex,o),style:e.styleObj(t,s,r+e.store.states.visibleRowStartIndex,o,e.columnsWidth),attrs:{title:t[s.key],\"data-key\":s.key},on:{mouseenter:function(t){return e.multiSelect(t,o,r+e.store.states.visibleRowStartIndex,s.type)},mousedown:function(t){return t.preventDefault(),e.selectCell(t,o,r+e.store.states.visibleRowStartIndex,s.type)}}},[\"selection\"===s.type&&e.dataStatusList[r+e.store.states.visibleRowStartIndex]?i(\"el-checkbox\",{attrs:{size:\"mini\"},on:{change:e.selectionChange},model:{value:e.dataStatusList[r+e.store.states.visibleRowStartIndex].checked,callback:function(t){e.$set(e.dataStatusList[r+e.store.states.visibleRowStartIndex],\"checked\",t)},expression:\"dataStatusList[yIndex + store.states.visibleRowStartIndex].checked\"}}):i(\"div\",{staticClass:\"ww-cell-content\",style:{\"max-width\":e.columnsWidth[o]+\"px\"}},[e._v(e._s(e.format(t[s.key],s.type,s.format)))])],1)})),0)})),e._v(\" \"),0!==e.showData.length||e.fixed?e._e():i(\"div\",{staticClass:\"ww-empty-block\"},[e._v(\"暂无数据\")])],2)])}),[],!1,null,null,null).exports),g=(i(\"ZhHq\"),i(\"53J1\")),k=i.n(g),A=(i(\"Hxq+\"),i(\"TkuN\")),S=i.n(A),C=(i(\"gmu+\"),i(\"wmP1\")),I={props:{columnsWidth:{type:Array,default:function(){return[]}},fixedCount:[String,Number],store:{required:!0}},components:{\"el-date-picker\":i.n(C).a,\"el-select\":S.a,\"el-option\":k.a},data:function(){return{editContent:\"\"}},computed:{cellEditorStyle:function(){var e=this,t=this.editor.editorIsFixed?this.columnsWidth.filter((function(t,i){return i<e.editor.editorXIndex})).reduce((function(e,t){return e+t}),0):this.columnsWidth.filter((function(t,i){return i<e.editor.editorXIndex})).reduce((function(e,t){return e+t}),0)-this.store.states.tableBodyLeft;return{top:\"\".concat(this.editor.editorYIndex*this.rowHeight-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(t,\"px\"),width:\"\".concat(this.columnsWidth[this.editor.editorXIndex],\"px\"),height:\"\".concat(this.rowHeight,\"px\"),\"z-index\":this.editor.editorIsFixed?4:1}},autofillHandlerStyle:function(){var e=this,t=this.editor.editorIsFixed&&this.selector.selectedYArr[0]===this.selector.selectedYArr[1]?this.columnsWidth.filter((function(t,i){return i<e.autofill.autofillXIndex})).reduce((function(e,t){return e+t}),0):this.columnsWidth.filter((function(t,i){return i<e.autofill.autofillXIndex})).reduce((function(e,t){return e+t}),0)-this.store.states.tableBodyLeft;return t=t+this.columnsWidth[this.autofill.autofillXIndex]-5,{top:\"\".concat((this.autofill.autofillYIndex+1)*this.rowHeight-4-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(t,\"px\"),\"z-index\":this.fixedCount>this.autofill.autofillXIndex?4:1}},selectedStyle:function(){var e=this;return{top:\"\".concat(this.selector.selectedYArr[0]*this.rowHeight-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(this.columnsWidth.filter((function(t,i){return i<e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0)-this.store.states.tableBodyLeft,\"px\"),width:\"\".concat(this.columnsWidth.filter((function(t,i){return i<=e.selector.selectedXArr[1]&&i>=e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0),\"px\"),height:\"\".concat((this.selector.selectedYArr[1]-this.selector.selectedYArr[0]+1)*this.rowHeight,\"px\")}},fixedSelectedStyle:function(){var e=this;return{top:\"\".concat(this.selector.selectedYArr[0]*this.rowHeight-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(this.columnsWidth.filter((function(t,i){return i<e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0),\"px\"),width:\"\".concat(this.columnsWidth.filter((function(t,i){return i<=e.selector.selectedXArr[1]&&i>=e.selector.selectedXArr[0]&&e.columns[i].fixed})).reduce((function(e,t){return e+t}),0),\"px\"),height:\"\".concat((this.selector.selectedYArr[1]-this.selector.selectedYArr[0]+1)*this.rowHeight,\"px\")}},autofillStyle:function(){var e=this;return{top:\"\".concat(this.autofill.autofillYArr[0]*this.rowHeight-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(this.columnsWidth.filter((function(t,i){return i<e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0)-this.store.states.tableBodyLeft,\"px\"),width:\"\".concat(this.columnsWidth.filter((function(t,i){return i<=e.selector.selectedXArr[1]&&i>=e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0),\"px\"),height:\"\".concat(0<this.autofill.autofillYArr.length?(this.autofill.autofillYArr[1]-this.autofill.autofillYArr[0]+1)*this.rowHeight:0,\"px\")}},fixedAutofillStyle:function(){var e=this;return{top:\"\".concat(this.autofill.autofillYArr[0]*this.rowHeight-this.store.states.tableBodyTop+this.theaderHeight,\"px\"),left:\"\".concat(this.columnsWidth.filter((function(t,i){return i<e.selector.selectedXArr[0]})).reduce((function(e,t){return e+t}),0),\"px\"),width:\"\".concat(this.columnsWidth.filter((function(t,i){return i<=e.selector.selectedXArr[1]&&i>=e.selector.selectedXArr[0]&&e.columns[i].fixed})).reduce((function(e,t){return e+t}),0),\"px\"),height:\"\".concat(0<this.autofill.autofillYArr.length?(this.autofill.autofillYArr[1]-this.autofill.autofillYArr[0]+1)*this.rowHeight:0,\"px\")}},theaderHeight:function(){return this.store.states.theaderHeight},rowHeight:function(){return this.store.states.rowHeight},columns:function(){return this.store.states.columns},editor:function(){return this.store.states.editor},selector:function(){return this.store.states.selector},autofill:function(){return this.store.states.autofill}},watch:{\"editor.editing\":{handler:function(e){e||(\"number\"===this.columns[this.editor.editorXIndex].type&&this.limitNumber(this.editContent,!0),this.store.getEditorContent(this.editContent),this.editContent=\"\")}}},methods:{limitNumber:function(e,t){var i;try{i=e.replace(/[^\\d.-]/g,\"\")}catch(e){return}/^0\\d+/.test(i)&&(i=i.replace(/0/,\"\")),t&&isNaN(i)&&(i=\"\"),this.editContent=i},setEditing:function(){this.$parent.setEditing()},clipboardToContent:function(e){this.$parent.clipboardToContent(e)},handleAutofill:function(){this.store.handleAutofill(),window.addEventListener(\"mousemove\",this.$parent.multiSelectAdjustPostion)},resetEditor:function(){this.store.resetEditor()}}},W=(i(\"hbnG\"),Object(m.a)(I,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",[i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.editor.editorShow,expression:\"editor.editorShow\"}],staticClass:\"ww-cell-editor\",class:{else:\"text\"!=e.editor.editType&&\"number\"!=e.editor.editType},style:e.cellEditorStyle,attrs:{title:e.editContent||e.editor.curEditorCoverValue},on:{dblclick:e.setEditing}},[i(\"textarea\",{ref:\"clipboard\",staticClass:\"ww-clipboard\",on:{paste:e.clipboardToContent}}),e._v(\" \"),i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.editor.editing,expression:\"editor.editing\"}],staticStyle:{flex:\"1\"}},[\"text\"==e.editor.editType?i(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.editContent,expression:\"editContent\"}],ref:\"text\",domProps:{value:e.editContent},on:{input:function(t){t.target.composing||(e.editContent=t.target.value)}}}):\"date\"===e.editor.editType?i(\"el-date-picker\",{ref:\"date\",style:{width:(140<e.editor.curEditorWidth?e.editor.curEditorWidth:140)+\"px\"},attrs:{size:\"mini\",\"value-format\":\"yyyy-MM-dd\",type:\"date\"},on:{blur:e.resetEditor},model:{value:e.editContent,callback:function(t){e.editContent=t},expression:\"editContent\"}}):\"month\"===e.editor.editType?i(\"el-date-picker\",{ref:\"month\",style:{width:(140<e.editor.curEditorWidth?e.editor.curEditorWidth:140)+\"px\"},attrs:{size:\"mini\",\"value-format\":\"yyyy-MM\",type:\"month\"},on:{blur:e.resetEditor},model:{value:e.editContent,callback:function(t){e.editContent=t},expression:\"editContent\"}}):\"select\"===e.editor.editType?i(\"el-select\",{ref:\"select\",style:{width:e.editor.curEditorWidth+\"px\"},attrs:{size:\"mini\",\"automatic-dropdown\":!0,placeholder:\"请选择\",clearable:\"\"},model:{value:e.editContent,callback:function(t){e.editContent=t},expression:\"editContent\"}},e._l(e.editor.options,(function(e){return i(\"el-option\",{key:e.value,attrs:{value:e.value,label:e.label}})})),1):\"number\"===e.editor.editType?i(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:e.editContent,expression:\"editContent\"}],ref:\"number\",domProps:{value:e.editContent},on:{input:[function(t){t.target.composing||(e.editContent=t.target.value)},function(t){return e.limitNumber(e.editContent)}],paste:function(t){return e.limitNumber(e.editContent)}}}):e._e()],1)]),e._v(\" \"),i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!e.editor.editing&&e.editor.editorShow,expression:\"!editor.editing && editor.editorShow\"}],ref:\"autofillHandler\",staticClass:\"ww-autofill-handler\",style:e.autofillHandlerStyle,on:{mousedown:e.handleAutofill}}),e._v(\" \"),i(\"div\",{staticClass:\"ww-cover-area selected\",style:e.selectedStyle}),e._v(\" \"),i(\"div\",{staticClass:\"ww-cover-area selected fixed\",style:e.fixedSelectedStyle}),e._v(\" \"),i(\"div\",{staticClass:\"ww-cover-area autofill\",style:e.autofillStyle}),e._v(\" \"),i(\"div\",{staticClass:\"ww-cover-area autofill fixed\",style:e.fixedAutofillStyle})])}),[],!1,null,null,null).exports),Y={directives:{clickoutside:h},props:{columnsWidth:{type:Array,default:function(){return[]}},fixedCount:[String,Number],value:{type:Object,default:function(){return{}}},store:{required:!0}},components:{\"el-checkbox\":o.a},data:function(){return{left:0}},computed:{filterBtnStyle:function(){var e=this,t=!1;return Object.keys(this.dropdown.list).forEach((function(i){e.dropdown.list[i].checked&&(t=!0)})),t?{}:{cursor:\"not-allowed\",color:\"#c0c4cc\"}},dropdown:function(){return this.store.states.dropdown}},watch:{\"dropdown.index\":{handler:function(e){var t,i=this;e&&(t=this.dropdown.index<this.fixedCount?this.store.states.tableBodyLeft+this.columnsWidth.filter((function(e,t){return t<=i.dropdown.index})).reduce((function(e,t){return e+t}),0):this.columnsWidth.filter((function(e,t){return t<=i.dropdown.index})).reduce((function(e,t){return e+t}),0),this.$nextTick((function(){(t=t-i.$refs.dropdown.offsetWidth+i.$parent.$refs.wrapper.offsetLeft-i.store.states.tableBodyLeft)<i.$parent.$refs.wrapper.offsetLeft&&(t=i.$parent.$refs.wrapper.offsetLeft),i.left=\"\".concat(t,\"px\")})))}}},methods:{openDropdown:function(){this.store.openDropdown()},sort:function(e){this.store.sort(e)},handleFilter:function(){var e=this,t=!1;Object.keys(this.dropdown.list).forEach((function(i){e.dropdown.list[i].checked&&(t=!0)})),t&&(this.store.handleFilter(),this.$parent.handleResize())},resetFilter:function(){this.store.resetFilter(),this.$parent.handleResize()}}},H=(i(\"S35C\"),Object(m.a)(Y,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{directives:[{name:\"clickoutside\",rawName:\"v-clickoutside\",value:e.openDropdown,expression:\"openDropdown\"}],ref:\"dropdown\",staticClass:\"ww-dropdown-wrapper\",class:{active:0<=parseInt(e.dropdown.index)},style:{top:e.$parent.$refs.wrapper.offsetTop+e.store.states.theaderHeight+\"px\",left:e.left}},[i(\"div\",{staticClass:\"ww-sort\"},[i(\"span\",{class:{active:\"ascending\"==e.dropdown.sort},on:{click:function(t){return e.sort(\"ascending\")}}},[e._v(\"升序\")]),e._v(\" \"),i(\"span\",{class:{active:\"descending\"==e.dropdown.sort},on:{click:function(t){return e.sort(\"descending\")}}},[e._v(\"降序\")])]),e._v(\" \"),i(\"div\",{staticClass:\"ww-filter\"},[e._m(0),e._v(\" \"),i(\"ul\",{staticClass:\"content\"},e._l(e.dropdown.list,(function(t,r){return i(\"li\",{key:r},[i(\"el-checkbox\",{staticStyle:{\"margin-right\":\"2px\"},attrs:{size:\"mini\"},model:{value:t.checked,callback:function(i){e.$set(t,\"checked\",i)},expression:\"item.checked\"}}),e._v(\" \"),i(\"p\",[i(\"span\",{attrs:{title:r}},[e._v(e._s(r))]),e._v(\" \"),i(\"i\",[e._v(\"（\"+e._s(t.count)+\"）\")])])],1)})),0),e._v(\" \"),i(\"div\",{staticClass:\"btns\"},[i(\"span\",{style:e.filterBtnStyle,on:{click:e.handleFilter}},[e._v(\"筛选\")]),e._v(\" \"),i(\"span\",{on:{click:e.resetFilter}},[e._v(\"重置\")])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",{staticClass:\"title\"},[this._v(\"名称\"),t(\"span\",[this._v(\"（计数）\")])])}],!1,null,null,null).exports),X={x:\"tableWidth\",y:\"tableHeight\"},D={x:\"mainWidth\",y:\"mainHeight\"},_={x:\"pageX\",y:\"pageY\"},L={x:\"xWidth\",y:\"yHeight\"},T={x:\"posX\",y:\"posY\"},j={x:\"tableBodyLeft\",y:\"tableBodyTop\"},O={props:{store:{required:!0},barType:{type:String}},data:function(){return{canScroll:!1,oriMousePos:0}},computed:{scrollbar:function(){return this.store.states.scrollbar},boxStyle:function(){var e=\"\".concat(this.scrollbar[L[this.barType]],\"px\");return\"x\"===this.barType?{width:e,transform:\"translateX(\".concat(this.scrollbar[T[this.barType]],\"px)\")}:\"y\"===this.barType?{height:e,transform:\"translateY(\".concat(this.scrollbar[T[this.barType]],\"px)\")}:{}}},methods:{handleDown:function(e){this.canScroll=!0,this.oriMousePos=e[_[this.barType]]-this.scrollbar[T[this.barType]],window.addEventListener(\"mouseup\",this.handleUp),window.addEventListener(\"mousemove\",this.handleMove)},handleMove:function(e){var t,i=this.store.states,r=this.barType;this.canScroll&&((t=e[_[r]]-this.oriMousePos)<=0?i.scrollbar[T[r]]=0:t>=i[D[r]]-i.scrollbar[L[r]]?i.scrollbar[T[r]]=i[D[r]]-i.scrollbar[L[r]]:i.scrollbar[T[r]]=t,i[j[r]]=this.scrollbar[T[r]]/(i[D[r]]-this.scrollbar[L[r]])*(i[X[r]]-i[D[r]]))},handleUp:function(){this.canScroll=!1,window.removeEventListener(\"mouseup\",this.handleUp),window.removeEventListener(\"mousemove\",this.handleMove)}}};function E(e,t){if(e){if(\"string\"==typeof e)return $(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===i&&e.constructor&&(i=e.constructor.name),\"Map\"===i||\"Set\"===i?Array.from(e):\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?$(e,t):void 0}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function B(e,t){var i,r=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)),r}i(\"Zg3/\");var N={name:\"vue-excel-table\",directives:{clickoutside:h},components:{TableHeader:y,TableBody:b,Editor:W,Dropdown:H,Scroll:Object(m.a)(O,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{staticClass:\"ww-scroll-wrap\",class:e.barType},[i(\"div\",{staticClass:\"ww-scroll-box\",style:e.boxStyle,on:{mousedown:e.handleDown}})])}),[],!1,null,null,null).exports},props:{value:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},maxHeight:{type:[String,Number],default:function(){return window.innerHeight}},rowHeight:{type:[String,Number],default:28},theaderHeight:{type:[String,Number],default:30},disabled:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!1},cellStyle:{type:[Object,Function],default:function(){return function(){return{}}}},cellClassName:{type:[Object,Function],default:function(){return function(){return{}}}}},data:function(){return{store:new u,wrapperWidth:null,columnsWidth:[],allSetWidth:!1,data:[],scrollLeftArr:[],scrollTopArr:[],fixedCount:0,fixedWidth:0,mouseX:0,mouseY:0,excelPos:{}}},computed:{tableWidth:function(){return this.store.states.tableWidth},tableHeight:function(){return this.store.states.tableHeight},tableBodyTop:function(){return this.store.states.tableBodyTop},tableBodyLeft:function(){return this.store.states.tableBodyLeft}},watch:{value:function(e){this.data=e},data:{handler:function(e){var t=this.store.states;t.isOperation||(t.historyData.length!==t.curHisory&&(t.historyData=t.historyData.slice(0,t.curHisory)),t.historyData.push(JSON.stringify(e)),t.curHisory+=1),this.$emit(\"input\",e),t.initialData||this.initData(),this.store.handleFilters(),this.store.handleChangeData(),this.store.handleErrors(),this.handleResize()},deep:!0},columns:{handler:function(){var e=this;this.initColumns(),this.store.handleFilters(),setTimeout((function(){e.handleResize()}),0)},deep:!0},tableBodyTop:function(){this.store.calcDomData()},tableBodyLeft:function(){this.store.states.dropdown.index=null}},mounted:function(){this.init()},mixins:[f,{methods:{selectionChange:function(){var e=this.store.states,t=this.store.states.showData.filter((function(t,i){return e.dataStatusList[i].checked}));this.$emit(\"selection-change\",t),e.dataStatusList.every((function(e){return e.checked}))?(this.$refs.theader.checkedAll=!0,this.$refs.fixedTheader.checkedAll=!0):(this.$refs.theader.checkedAll=!1,this.$refs.fixedTheader.checkedAll=!1)}}}],methods:{init:function(){var e=this;0<this.value.length&&(this.data=this.value),this.store.states.rowHeight=this.rowHeight,window.addEventListener(\"resize\",(function(){e.handleResize()})),this.store.handleIsMac(),this.initColumns(),this.handleResize(),this.handleMousewheel()},handleMousewheel:function(){function e(e){var r,s;t.tableHeight<=t.maxHeight||(r=i.tableBodyTop,s=i.tableBodyLeft,e.wheelDelta?e.wheelDeltaY?r-=e.wheelDelta:s-=e.wheelDelta:2===e.axis?r+=40*e.detail:s+=40*e.detail,t.store.setScrollStatus(r,s))}var t=this,i=this.store.states;this.$refs.tbody.$el.addEventListener(\"mousewheel\",e),this.$refs.tbody.$el.addEventListener(\"DOMMouseScroll\",e),this.$nextTick((function(){t.$refs.fixedTbody.$el.addEventListener(\"mousewheel\",e),t.$refs.fixedTbody.$el.addEventListener(\"DOMMouseScroll\",e)}))},initColumns:function(){var e=this.store.states,t=this.columns.filter((function(e){return e.fixed})),i=this.columns.filter((function(e){return!e.fixed}));e.columns=t.concat(i).map((function(e){return e.width&&(e.width=parseInt(e.width,10)),function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?B(Object(i),!0).forEach((function(t){var r,s,o;r=e,o=i[s=t],s in r?Object.defineProperty(r,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[s]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):B(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e)})),this.columnsWidth=e.columns.map((function(e){return e.width})),e.columnsStatusList=e.columns.map((function(e){return{key:e.key,type:e.type,list:{},sort:\"\"}})),e.filters={}},initData:function(){var e=this.store.states;e.data=this.data,e.showData=this.data,e.dataStatusList=this.data.map((function(){return{checked:!1,errors:[]}})),e.initialData=JSON.parse(JSON.stringify(e.data)),e.historyData=[JSON.stringify(e.data)],e.curHisory=1,this.$refs.theader&&(this.$refs.theader.checkedAll=!1),this.$refs.fixedTheader&&(this.$refs.fixedTheader.checkedAll=!1),this.initColumns(),this.store.calcDomData()},handleResize:function(){var e=this,t=this.store.states;this.excelPos=this.$refs.excelTable.getBoundingClientRect(),t.editor.editorRange={minX:t.columns.filter((function(e){return\"selection\"===e.type})).length,maxX:t.columns.length-1,minY:0,maxY:t.showData.length-1},this.wrapperWidth=this.$refs.wrapper.offsetWidth,this.$nextTick((function(){var i,r,s=t.columns.filter((function(e){return!e.width}));e.$refs.tbody.$el&&(0<s.length&&0<(r=e.wrapperWidth-t.columns.filter((function(e){return e.width})).reduce((function(e,t){return e+t.width}),0))&&(i=e.$refs.tbody.$el.offsetHeight>e.maxHeight?(r-1-t.scrollBarWidth)/s.length:(r-1)/s.length),t.columns.forEach((function(t,r){t.width?e.$set(e.columnsWidth,r,t.width):80<i?e.$set(e.columnsWidth,r,i):e.$set(e.columnsWidth,r,80)})),e.scrollLeftArr=e.columnsWidth.map((function(t,i){return e.columnsWidth.reduce((function(e,t,r){return r<=i?e+t:e}),0)})),e.scrollTopArr=t.showData.map((function(i,r){return t.showData.reduce((function(t,i,s){return s<=r?t+parseInt(e.rowHeight,10):t}),0)})),e.scrollTopArr.unshift(0),e.fixedCount=t.columns.filter((function(e){return e.fixed})).length,e.fixedWidth=e.scrollLeftArr[e.fixedCount-1]||0,e.allSetWidth=t.columns.every((function(e){return e.width})),e.allSetWidth?t.tableWidth=t.columns.map((function(e){return e.width})).reduce((function(e,t){return e+t}),0):(t.tableWidth=e.columnsWidth.reduce((function(e,t){return e+t}),0),t.tableWidth<e.wrapperWidth&&(t.tableWidth=e.wrapperWidth)))})),t.theaderHeight=this.theaderHeight,t.mainWidth=this.$refs.wrapper.offsetWidth-t.scrollBarWidth,t.mainHeight=this.maxHeight+this.theaderHeight,t.tableHeight=t.showData.length*this.rowHeight+this.theaderHeight,this.store.initScrollBarLength(),this.store.calcDomData()},clickoutside:function(){var e=this.store.states;e.selector.isSelected||e.autofill.isAutofill||(e.editor.editing=!1,e.editor.editorShow=!1,e.selector.selectedXArr=[],e.selector.selectedYArr=[],window.removeEventListener(\"keydown\",this.keySubmit),window.removeEventListener(\"mousemove\",this.multiSelectAdjustPostion))},selectCell:function(e,t,i,r){var s,o=this;this.disabled||0===e.button&&(s=this.store.states,window.addEventListener(\"keydown\",this.keySubmit),window.addEventListener(\"mousemove\",this.multiSelectAdjustPostion),\"selection\"!==r&&(window.addEventListener(\"mouseup\",this.selectUp),s.editor.editing=!1,s.editor.editType=\"text\",s.editor.editorShow=!0,s.autofill.autofillXIndex=t,s.autofill.autofillYIndex=i,s.selector.selectedXIndex=t,s.selector.selectedYIndex=i,s.selector.selectedXArr=[t,t],s.selector.selectedYArr=[i,i],s.selector.isSelected=!0,this.$nextTick((function(){s.editor.editorXIndex=t,s.editor.editorYIndex=i,s.editor.curEditorCoverValue=s.showData[s.editor.editorYIndex][s.columns[s.editor.editorXIndex].key],o.$nextTick((function(){o.adjustPosition(),o.$refs.editor.$refs.clipboard.focus()}))}))))},keySubmit:function(e){var t=this.store.states,i=e.keyCode,r=e.ctrlKey,s=e.metaKey;if(r&&90===i||s&&90===i)return this.store.operation(\"undo\");if(r&&89===i||s&&89===i)return this.store.operation(\"recovery\");if(t.editor.editing&&(13===i||27===i))return t.editor.editing=!1,void(t.editor.editType=\"text\");if(!t.editor.editing&&t.editor.editorShow){if(r&&67===i||s&&67===i)return this.getContentToclipboard();if(r&&65===i||s&&65===i)return this.store.selectAllCells();var o;if(!r&&!s)switch(e.preventDefault(),!0){case 37===i:t.editor.editorXIndex===t.editor.editorRange.minX?t.editor.editorXIndex=t.editor.editorRange.minX:--t.editor.editorXIndex,this.adjustPosition();break;case 38===i:t.editor.editorYIndex===t.editor.editorRange.minY?t.editor.editorYIndex=t.editor.editorRange.minY:--t.editor.editorYIndex,this.adjustPosition();break;case 39===i:t.editor.editorXIndex===t.editor.editorRange.maxX?t.editor.editorXIndex=t.editor.editorRange.maxX:t.editor.editorXIndex+=1,this.adjustPosition();break;case 40===i:t.editor.editorYIndex===t.editor.editorRange.maxY?t.editor.editorYIndex=t.editor.editorRange.maxY:t.editor.editorYIndex+=1,this.adjustPosition();break;case 8===i||46===i:this.store.clearSelected();break;case 13===i:this.setEditing();break;case 65<=(o=i)&&o<=90||48<=o&&o<=57||96<=o&&o<=107||109<=o&&o<=111||32===o||186<=o&&o<=222||\"Process\"===e.key||\"Unidentified\"===e.key:this.setEditing(e.key)}}},getContentToclipboard:function(){for(var e=this.store.states,t=\"\",i=0;i<=e.selector.selectedYArr[1]-e.selector.selectedYArr[0];i+=1)for(var r=0;r<=e.selector.selectedXArr[1]-e.selector.selectedXArr[0];r+=1)e.selector.selectedXArr[1]-e.selector.selectedXArr[0]==0?t+=\"\".concat(e.showData[i+e.selector.selectedYArr[0]][e.columns[r+e.selector.selectedXArr[0]].key]||\"\",\"\\n\"):0===r?t+=e.showData[i+e.selector.selectedYArr[0]][e.columns[r+e.selector.selectedXArr[0]].key]||\"\":r===e.selector.selectedXArr[1]-e.selector.selectedXArr[0]?t+=\"\\t\".concat(e.showData[i+e.selector.selectedYArr[0]][e.columns[r+e.selector.selectedXArr[0]].key]||\"\",\"\\n\"):t+=\"\\t\".concat(e.showData[i+e.selector.selectedYArr[0]][e.columns[r+e.selector.selectedXArr[0]].key]||\"\");var s=document.createElement(\"textarea\");s.value=t,document.body.appendChild(s),s.select();try{var o=document.execCommand(\"copy\");console.log(o)}catch(e){console.log(e)}document.body.removeChild(s)},clipboardToContent:function(e){var t=this;setTimeout((function(){var i=t.store.states,r=[];e.target.value.split(\"\\n\").forEach((function(e,t,s){(i.isMac||t<s.length-1)&&r.push(e.split(\"\\t\"))}));var s=i.selector.selectedXArr[1]-i.selector.selectedXArr[0]+1,o=i.selector.selectedYArr[1]-i.selector.selectedYArr[0]+1;if(o%r.length==0&&s%r[0].length==0)for(var n=0;n<=o-1;n+=1)for(var l=0;l<=s-1;l+=1)i.columns[l+i.selector.selectedXArr[0]].disabled||(i.showData[n+i.selector.selectedYArr[0]][i.columns[l+i.selector.selectedXArr[0]].key]=r[n%r.length][l%r[0].length]);else for(var a=0;a<=r.length-1;a+=1)for(var d=0;d<=r[a].length-1;d+=1)i.showData[a+i.selector.selectedYArr[0]]&&i.columns[d+i.selector.selectedXArr[0]]&&(i.columns[d+i.selector.selectedXArr[0]].disabled||(i.showData[a+i.selector.selectedYArr[0]][i.columns[d+i.selector.selectedXArr[0]].key]=r[a][d]));t.$refs.editor.$refs.clipboard.value=\"\"}),0)},setEditing:function(e){var t,i=this,r=this.store.states;r.columns[r.editor.editorXIndex].disabled||(r.editor.editType=r.columns[r.editor.editorXIndex].type?r.columns[r.editor.editorXIndex].type:\"text\",r.editor.curEditorWidth=this.columnsWidth[r.editor.editorXIndex],!e||\"text\"!==r.editor.editType&&\"number\"!==r.editor.editType?this.$refs.editor.editContent=r.showData[r.editor.editorYIndex][r.columns[r.editor.editorXIndex].key]:\"Process\"===e||\"Unidentified\"===e?e.match(/\\d/)?(t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],r=!0,s=!1,o=void 0;try{for(var n,l=e[Symbol.iterator]();!(r=(n=l.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(s)throw o}}return i}}(e,t)||E(e,t)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}(e.match(/\\d/),1),this.$refs.editor.editContent=t[0]):this.$refs.editor.editContent=\"\":this.$refs.editor.editContent=e,r.editor.editing=!0,\"select\"===r.editor.editType&&(r.editor.options=r.columns[r.editor.editorXIndex].options),this.$nextTick((function(){i.$refs.editor.$refs[r.editor.editType].focus()})))},selectUp:function(){var e=this;setTimeout((function(){e.store.states.selector.isSelected=!1}),0)},adjustPosition:function(){var e,t,i,r,s,o,n,l=this,a=this.store.states;a.editor.editorXIndex<this.fixedCount?a.editor.editorIsFixed=!0:a.editor.editorIsFixed=!1,a.autofill.autofillXIndex=a.editor.editorXIndex,a.autofill.autofillYIndex=a.editor.editorYIndex,a.selector.selectedXArr=[a.editor.editorXIndex,a.editor.editorXIndex],a.selector.selectedYArr=[a.editor.editorYIndex,a.editor.editorYIndex],r=0<this.fixedCount?(e=this.scrollLeftArr.slice(this.fixedCount-1,-1).map((function(e){return e-l.fixedWidth})),t=this.scrollLeftArr.slice(this.fixedCount).map((function(e){return e-l.fixedWidth})),i=e[a.editor.editorXIndex-this.fixedCount],t[a.editor.editorXIndex-this.fixedCount]+this.fixedWidth-this.wrapperWidth+a.scrollBarWidth+1):(i=(s=[0].concat(function(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||E(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}(this.scrollLeftArr)))[a.editor.editorXIndex],s[a.editor.editorXIndex+1]-this.wrapperWidth+a.scrollBarWidth+1),a.tableWidth>this.wrapperWidth&&(a.tableBodyLeft>i&&(a.tableBodyLeft=i),a.tableBodyLeft<r&&(a.tableBodyLeft=r),a.scrollbar.posX=a.tableBodyLeft/(a.tableWidth-a.mainWidth)*(a.mainWidth-a.scrollbar.xWidth)),this.maxHeight&&(o=this.scrollTopArr[a.editor.editorYIndex]+1,a.tableBodyTop>o&&(a.tableBodyTop=o),n=this.scrollTopArr[a.editor.editorYIndex+1]-this.maxHeight+1,a.tableBodyTop<n&&(a.tableBodyTop=n),a.scrollbar.posY=a.tableBodyTop/(a.tableHeight-a.mainHeight)*(a.mainHeight-a.scrollbar.yHeight))},multiSelectAdjustPostion:function(e){var t=this,i=this.store.states;if(i.selector.isSelected||i.autofill.isAutofill){if(e&&(e=e||window.event,this.mouseX=e.pageX,this.mouseY=e.pageY),i.selector.selectedYArr[0]===i.selector.selectedYArr[1]&&i.selector.selectedXArr[0]===i.selector.selectedXArr[1])return;var r=this.$refs.excelTable.offsetTop+this.theaderHeight,s=this.excelPos.left+this.fixedWidth,o=this.$refs.excelTable.offsetTop+this.$refs.excelTable.offsetHeight-10,n=this.excelPos.left+this.$refs.excelTable.offsetWidth-10,l=i.tableBodyTop,a=i.tableBodyLeft;this.tableHeight>this.maxHeight&&(this.mouseY<r&&(l-=20),this.mouseY>o&&(l+=20)),this.mouseX<s&&(a-=20),this.mouseX>n&&(a+=20),this.store.setScrollStatus(l,a),setTimeout((function(){t.multiSelectAdjustPostion()}),16)}else window.removeEventListener(\"mousemove\",this.multiSelectAdjustPostion)},selectAll:function(){var e=this,t=this.store.states,i=t.dataStatusList.every((function(e){return e.checked}));t.dataStatusList.forEach((function(r,s){e.$set(t.dataStatusList[s],\"checked\",!i)})),this.selectionChange()},adjustWidth:function(e,t){this.store.states.columns[e].width=t,this.handleResize()}}},P=(i(\"0UNb\"),{name:\"App\",components:{ExcelTable:Object(m.a)(N,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{ref:\"excelTable\",staticClass:\"ww-excel-table\",style:{width:e.allSetWidth&&e.tableWidth<=e.wrapperWidth?e.tableWidth+\"px\":\"\"}},[i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:0<e.store.states.columns.length,expression:\"store.states.columns.length > 0\"},{name:\"clickoutside\",rawName:\"v-clickoutside\",value:e.clickoutside,expression:\"clickoutside\"}],ref:\"wrapper\",staticClass:\"ww-table-wrapper\",class:{scrollX:e.tableWidth>e.wrapperWidth,scrollY:e.tableHeight>e.maxHeight}},[i(\"table-header\",{ref:\"theader\",attrs:{showIcon:e.showIcon,columnsWidth:e.columnsWidth,fixedCount:e.fixedCount,\"all-show\":!0,store:e.store}}),e._v(\" \"),i(\"table-body\",{ref:\"tbody\",style:{maxHeight:e.maxHeight+\"px\"},attrs:{columnsWidth:e.columnsWidth,\"all-show\":!0,cellStyle:e.cellStyle,cellClassName:e.cellClassName,store:e.store}}),e._v(\" \"),i(\"editor\",{ref:\"editor\",attrs:{columnsWidth:e.columnsWidth,fixedCount:e.fixedCount,store:e.store}}),e._v(\" \"),i(\"table-header\",{ref:\"fixedTheader\",style:{width:e.fixedWidth+\"px\"},attrs:{fixed:!0,showIcon:e.showIcon,columnsWidth:e.columnsWidth,fixedCount:e.fixedCount,store:e.store}}),e._v(\" \"),i(\"table-body\",{ref:\"fixedTbody\",style:{width:e.fixedWidth+\"px\"},attrs:{fixed:!0,columnsWidth:e.columnsWidth,cellStyle:e.cellStyle,cellClassName:e.cellClassName,store:e.store,scrollY:e.tableHeight>e.maxHeight}})],1),e._v(\" \"),i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:0===e.store.states.columns.length,expression:\"store.states.columns.length === 0\"}],staticClass:\"ww-empty-columns\"},[e._v(\"\\n    暂无表头\\n  \")]),e._v(\" \"),i(\"dropdown\",{attrs:{columnsWidth:e.columnsWidth,fixedCount:e.fixedCount,store:e.store}}),e._v(\" \"),i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.store.states.adjustLineShow,expression:\"store.states.adjustLineShow\"}],staticClass:\"ww-adjustLine\",style:{left:e.store.states.adjustLineLeft+\"px\"}}),e._v(\" \"),e.tableWidth>e.wrapperWidth?i(\"scroll\",{attrs:{barType:\"x\",store:e.store}}):e._e(),e._v(\" \"),i(\"scroll\",{attrs:{barType:\"y\",store:e.store}})],1)}),[],!1,null,null,null).exports,\"el-checkbox\":o.a},data:function(){var e=this;return{features:[{label:\"显示数据类型icon\",checked:!0,handleChange:function(t){e.showIcon=t}},{label:\"显示行多选\",checked:!0,handleChange:function(t){t?e.columns.unshift({type:\"selection\",width:40,fixed:!0}):e.columns.shift()}},{label:\"固定列（序号、姓名）\",checked:!0,handleChange:function(t){e.columns.forEach((function(e){[\"sid\",\"name\"].includes(e.key)&&(e.fixed=t)}))}},{label:\"启用筛选与过滤（序号、姓名、日期）\",checked:!1,handleChange:function(t){e.columns.forEach((function(i){[\"sid\",\"name\",\"date\"].includes(i.key)&&e.$set(i,\"action\",t)}))}},{label:\"禁止整表操作\",checked:!1,handleChange:function(t){e.disabled=t}},{label:\"禁止序号操作\",checked:!1,handleChange:function(t){e.columns.some((function(i){return\"sid\"===i.key&&(e.$set(i,\"disabled\",t),!0)}))}},{label:\"自定义单元格样式\",checked:!1,handleChange:function(t){e.cellStyle=t?function(e){var t=e.rowIndex,i=e.columnIndex;if(t%2==1&&i%2==0)return{color:\"#67C23A\"}}:function(){}}},{label:\"自定义单元格类名\",checked:!1,handleChange:function(t){e.cellClassName=t?function(e){var t=e.rowIndex,i=e.columnIndex;if(t%2==0&&i%2==1)return{customChanged:!0}}:function(){}}}],columns:[],columnsData:[{type:\"selection\",width:40,fixed:!0},{title:\"序号\",key:\"sid\",fixed:!0,type:\"number\",width:100},{title:\"姓名\",key:\"name\",fixed:!0,width:120},{title:\"日期\",key:\"date\",type:\"date\",width:100},{title:\"工作岗位\",key:\"email\",width:300,type:\"select\",options:[{value:\"Web前端开发\",label:\"Web前端开发\"},{value:\"Java开发\",label:\"Java开发\"},{value:\"Python开发\",label:\"Python开发\"},{value:\"Php开发\",label:\"Php开发\"}]},{title:\"月份\",key:\"month\",type:\"month\",width:100},{title:\"地址\",key:\"address\",width:200},{title:\"标题\",key:\"title\",width:300},{title:\"内容\",key:\"paragraph\",width:300},{title:\"链接\",key:\"url\",width:200},{title:\"ip\",key:\"ip\",width:200,validate:function(e){return/((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d{1,2})){3}/g.test(e)}},{title:\"总金额\",key:\"sum\",width:200},{title:\"ID\",key:\"id\",width:200},{title:\"色值\",key:\"color\",width:200}],data:[],showIcon:!0,disabled:!1,maxHeight:800,cellStyle:function(){},cellClassName:function(){}}},watch:{data:{handler:function(e){console.log(\"%clist\",\"color:red;font-size:16px;text-shadow:1px 1px 1px blue;\",e)},immediate:!0,deep:!0}},mounted:function(){this.getList(),this.maxHeight=document.documentElement.clientHeight-200},methods:{getList:function(){var e=this;this.columns=this.columnsData;var t=l.a.mock({\"list|100\":[{\"sid|+1\":1,\"userId|5\":\"\",\"sex|1-2\":!0,guid:\"@guid\",id:\"@id\",title:\"@title()\",paragraph:\"@cparagraph\",image:\"@image('200x100', '#4A7BF7', 'Hello')\",address:\"@county(true)\",date:'@date(\"yyyy-MM-dd\")',month:\"\",time:'@time(\"HH:mm:ss\")',url:\"@url\",email:\"Web前端开发\",ip:\"@ip\",sum:\"@ip\",regexp:/[a-z][A-Z][0-9]/,name:\"@name()\",color:\"@rgba()\"}]}),i=l.a.mock({\"list|100\":[{\"sid|+1\":10,\"userId|5\":\"\",\"sex|1-2\":!0,guid:\"@guid\",id:\"@id\",title:\"@title()\",paragraph:\"@cparagraph\",image:\"@image('200x100', '#4A7BF7', 'Hello')\",address:\"@county(true)\",date:'@date(\"yyyy-MM-dd\")',month:\"\",time:'@time(\"HH:mm:ss\")',url:\"@url\",email:\"Web前端开发\",ip:\"@ip\",sum:\"@ip\",regexp:/[a-z][A-Z][0-9]/,name:\"@name()\",color:\"@rgba()\"}]});this.$refs.excelTable.setData(t.list,null,100),setTimeout((function(){e.$refs.excelTable.setData(i.list,null,100)}),5e3)},getErrorRows:function(){console.log(this.$refs.excelTable.getErrorRows())},getChangeData:function(){console.log(this.$refs.excelTable.getChangeData())},selectionChange:function(){},add:function(){var e={};e.id=(new Date).getTime(),this.columns.forEach((function(t){t.key&&(e[t.key]=\"\")})),this.$refs.excelTable.addItem(e)},remove:function(){this.$refs.excelTable.removeItems(\"sid\",this.selection.map((function(e){return e.sid})))},linkGithub:function(){}}}),M=i(\"uemM\"),R=Object(m.a)(P,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",{attrs:{id:\"app\"}},[i(\"hgroup\",{class:e.s.title},[i(\"h2\",[e._v(\"从左侧勾选定制你的数据表格\")])]),e._v(\" \"),i(\"div\",{class:e.s.main},[i(\"div\",{class:e.s.features_wrapper},[i(\"div\",{class:e.s.features_title},[i(\"span\",[e._v(\"特征\")]),e._v(\" \"),i(\"button\",{class:e.s.github_link,on:{click:e.linkGithub}})]),e._v(\" \"),i(\"ul\",{class:e.s.features_list},e._l(e.features,(function(t,r){return i(\"li\",{key:r},[i(\"label\",[e._v(e._s(t.label))]),e._v(\" \"),i(\"el-checkbox\",{on:{change:t.handleChange},model:{value:t.checked,callback:function(i){e.$set(t,\"checked\",i)},expression:\"item.checked\"}})],1)})),0)]),e._v(\" \"),i(\"div\",{class:e.s.excel-e.table_wrapper},[i(\"excel-table\",{ref:\"excelTable\",attrs:{columns:e.columns,maxHeight:e.maxHeight,disabled:e.disabled,showIcon:e.showIcon,cellStyle:e.cellStyle,cellClassName:e.cellClassName,rowHeight:28},on:{\"selection-change\":e.selectionChange},model:{value:e.data,callback:function(t){e.data=t},expression:\"data\"}})],1)])])}),[],!1,(function(e){this.s=M.default.locals||M.default}),null,null).exports;i(\"tW1c\"),new r.default({render:function(e){return e(R)}}).$mount(\"#app\")},\"4IID\":function(e,t,i){},\"5NrJ\":function(e,t,i){},HQFz:function(e,t,i){},M7Qs:function(e,t,i){},NgJc:function(e,t,i){\"use strict\";var r=i(\"g1Q5\");i.n(r).a},S35C:function(e,t,i){\"use strict\";var r=i(\"5NrJ\");i.n(r).a},\"W+Kp\":function(e,t,i){\"use strict\";var r=i(\"M7Qs\");i.n(r).a},\"Y7/N\":function(e,t,i){},\"Zg3/\":function(e,t,i){\"use strict\";var r=i(\"sLwC\");i.n(r).a},g1Q5:function(e,t,i){},hbnG:function(e,t,i){\"use strict\";var r=i(\"HQFz\");i.n(r).a},sLwC:function(e,t,i){},tW1c:function(e,t,i){\"use strict\";i.r(t);var r=i(\"luuv\"),s=i.n(r);s.a.mock(\"https://demo.kevinmint.com/1.json\",\"get\",{\"list|100\":[{\"sid|+1\":1,\"userId|5\":\"\",\"sex|1-2\":!0,guid:\"@guid\",id:\"@id\",title:\"@title()\",paragraph:\"@cparagraph\",image:\"@image('200x100', '#4A7BF7', 'Hello')\",address:\"@county(true)\",date:'@date(\"yyyy-MM-dd\")',month:\"\",time:'@time(\"HH:mm:ss\")',url:\"@url\",email:\"@email\",ip:\"@ip\",sum:\"@ip\",regexp:/[a-z][A-Z][0-9]/,name:\"@name()\",color:\"@rgba()\"}]}),s.a.mock(\"http://2.json\",\"get\",{\"list|20\":[\"@range(1, 100, 9)\"]}),s.a.mock(\"http://3.json\",\"get\",{\"list|120\":[{\"sid|+1\":1,\"userId|5\":\"\",\"sex|1-2\":!0,guid:\"@guid\",id:\"@id\",title:\"@title()\",paragraph:\"@cparagraph\",image:\"@image('200x100', '#4A7BF7', 'Hello')\",address:\"@county(true)\",date:'@date(\"yyyy-MM-dd\")',month:\"\",time:'@time(\"HH:mm:ss\")',url:\"@url\",email:\"@email\",ip:\"@ip\",regexp:/[a-z][A-Z][0-9]/}]}),s.a.mock(\"http://4.json\",\"get\",{\"list|200\":[{\"sid|+1\":1,\"userId|5\":\"\",\"sex|1-2\":!0,guid:\"@guid\",id:\"@id\",title:\"@title()\",paragraph:\"@cparagraph\",image:\"@image('200x100', '#4A7BF7', 'Hello')\",address:\"@county(true)\",date:'@date(\"yyyy-MM-dd\")',month:\"\",time:'@time(\"HH:mm:ss\")',url:\"@url\",email:\"@email\",ip:\"@ip\",regexp:/[a-z][A-Z][0-9]/}]})},uemM:function(e,t,i){\"use strict\";var r=i(\"3GTM\"),s=i.n(r);t.default=s.a}},[[0,1,2]]]);","extractedComments":[]}